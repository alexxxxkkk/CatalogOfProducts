{% extends ':home:index.html.twig' %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ '/plugin/jquery.plugin.js' }}"></script>
    <script>
        $(document).ready(function () {
            $(document).on('mouseenter', '.product', function () {
                $(this).find(".admin").show();
            }).on('mouseleave', '.product', function () {
                $(this).find(".admin").hide();
            });
        });
    </script>
{% endblock %}
{% block body %}
    <div class="col-md-2 hidden-xs hidden-sm">
        {{ knp_menu_render('sidebar', {'currentClass': 'active'}) }}
    </div>
    <div class="col-xs-12 hidden-md hidden-lg">
        {{ knp_menu_render('accordeon', {'currentClass': 'active'}) }}
    </div>
    {% for flash_message in app.session.flashbag.get('message') %}
        <div class="alert alert-info" role="alert" style="margin: 1% 15%">
            {{ flash_message }}
        </div>
    {% endfor %}

    <div class="col-xs-12 col-md-9">
        <h1> Каталог товаров </h1>
        <div id="grid"></div>
    </div>

    {% if is_granted("ROLE_MODERATOR") %}
        <script>
            $('#grid').ajaxgrid({
                url: '/products', // URL, с которого тянуть данные
                sortableColumns: ['name', 'price'], // массив с именами полей сущности, по которым должна быть возможна сортировка
                filterableColumns: ['name', 'price', 'manufacturer'], // массив с именами полей сущности, по которым должна быть возможна фильтрация
                itemsPerPage: [8, 12, 20], // количество единиц на страницу для пагинации
                page: 1,
                admin: true
            });
        </script>
    {% else %}
        <script>
            $('#grid').ajaxgrid({
                url: '/products', // URL, с которого тянуть данные
                sortableColumns: ['name', 'price'], // массив с именами полей сущности, по которым должна быть возможна сортировка
                filterableColumns: ['name', 'price', 'manufacturer'], // массив с именами полей сущности, по которым должна быть возможна фильтрация
                itemsPerPage: [8, 12, 20], // количество единиц на страницу для пагинации
                page: 1,
                admin: false
            });
        </script>
    {% endif %}
{% endblock %}